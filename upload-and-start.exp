#!/usr/bin/expect -f

set timeout 60
set remote_host "10.102.32.144"
set remote_user "lab426"
set remote_pass "426"

puts "ğŸ“¤ ä¸Šä¼ å¯åŠ¨è„šæœ¬..."

# ä¸Šä¼ å¯åŠ¨è„šæœ¬
spawn scp -o StrictHostKeyChecking=no start.sh ${remote_user}@${remote_host}:~/aigc-security-platform/
expect {
    "password:" {
        send "${remote_pass}\r"
    }
}
expect eof

puts "ğŸš€ æ‰§è¡Œå¯åŠ¨è„šæœ¬..."

# SSHåˆ°æœåŠ¡å™¨å¹¶æ‰§è¡Œå¯åŠ¨è„šæœ¬
spawn ssh -o StrictHostKeyChecking=no ${remote_user}@${remote_host}
expect {
    "password:" {
        send "${remote_pass}\r"
    }
}

expect "$ " {
    send "cd ~/aigc-security-platform\r"
}

expect "$ " {
    send "chmod +x start.sh\r"
}

expect "$ " {
    send "./start.sh\r"
}

expect "$ " {
    send "sleep 3\r"
}

expect "$ " {
    send "tmux ls\r"
}

expect "$ " {
    send "curl -I http://localhost:5670\r"
}

expect "$ " {
    send "exit\r"
}

expect eof

puts "\nâœ… éƒ¨ç½²å®Œæˆï¼"
puts "ğŸŒ è®¿é—®åœ°å€: http://10.102.32.144:5670"



